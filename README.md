# AT2차 센터 지수 생성 코드

## 요약
    상권(시군구)별 요식업종 업체와 수입 식재료 간의 상관계수 추출 및 예측지수 추출

## 추출 방법
    + 서버에 존재하는 shell file을 통해 실행
        1. shell 파일 실행 
            + 파일명 : at2.sh

## 프로세스 설명
1. 지방인허가 요식업종 데이터 마트 추출
    + 기존 at 1차에서 사용했던 jar를 통해 데이터 추출 
    + 실행관련 정보
        + 1. 파라미터 적용 : <파라미터: 원하는 분석 시작년월(yyyymm), 종료년월(yyyymm)>
        + 2. 지방인허가 요식업종 마트 데이터 실행 : RunCateringMart
3. 수출입데이터를 이용하여 로컬 데이터 마트 및 수출입 데이터 마트 추출
    + 코드 : make_mart - ImpLclDataMart.py
    + 추출 후 DB에 저장
        + 로컬 데이터 마트 : LCL_DATA_MART
        + 수출입 데이터 마트 : IMP_DATA_MART
4. 상관계수를 추출하기 위한 데이터 마트 추출
    + 코드 : make_mart - CorrDataMart.py
    + 추출과정
        1. 분석연월 기준으로 1년치 수출입 데이터 마트 추출
        2. 1년동안 계속 수입한 재료 추출
        3. 위에서 추출한 데이터와 분석연월 로컬 데이터 마트를 통해 지수별 4가지 데이터 마트 추출
            + 지역별 업종별 인허가 시계열 데이터와 공통 식재료 개별 HS 코드별 시계열 데이터 Join (금액, 건수, 업체수, 중량) - makeCorrDataMart1 함수
            + 지역별 업종별 인허가 시계열 데이터와 해당 업종에 대응되는 개별 HS 코드별 - 공통식재료 HS 코드 시계열 데이터 Join (금액, 건수, 업체수, 중량) - makeCorrDataMart2 함수
            + 지역별 업종별 인허가 시계열 데이터와 해당 업종에 대응되는 HS 코드셋의 sum 시계열 데이터 Join (금액, 건수, 업체수, 중량) - makeCorrDataMart3 함수
            + 지역별 업종별 인허가 시계열 데이터와 해당 업종에 대응되는 HS 코드셋 - 공통식재료 HS 코드의 sum 시계열 데이터 Join (금액, 건수, 업체수, 중량) - makeCorrDataMart4 함수       
5. 지수별 상관계수 추출
    + 코드 : make_corr_socre - makeCorrDF.py 
    + 추출과정
        1. 각 지수별 데이터 마트를 통해 상관계수 추출
        2. 추출 후 DB 저장
6. 예측 지수값 추출  
    + 코드 : make_expect_score - makeExpectScoreDF.py 참조
    + 추출 과정
        1. 지수별 분석연월, 전월 상관계수 지수 값을 추출 후 차이 값을 예측지수로 추출
        2. 추출 후 DB 저장
    
    


     
